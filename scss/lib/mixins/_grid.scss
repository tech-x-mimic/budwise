@mixin gen-col($size, $columns, $gutter) {
  flex: 0 0 auto;
  width: percentage($size / $columns);
}

@mixin make-grid-row($gutter: $gutter-x-width) {
  .row {
    display: flex;
    flex-wrap: wrap;
    margin: 0 -#{abs($gutter)};

    // reduce css file size, avoid defining this in each col[-*] class.
    > * {
      padding: 0 abs($gutter);
    }
  }
}

@mixin make-grid-columns(
  $columns: $grid-columns,
  $breakpoints: $breakpoints,
  $gutter: $gutter-x-width
) {
  .col {
    flex: 1 0 0%;
  }

  @if $columns > 0 {
    @for $i from 1 through $columns {
      .col-#{$i} {
        @include gen-col($i, $columns, $gutter);
      }
    }

    // FIXME: Currently node-sass does not seem to support closures and 
    // no Passing Arguments to Content Blocks feat either
    // this is handy way to bundle media query class.
    @each $breakpoint in $media {
      @include responsive($breakpoint) {
        @for $i from 1 through $columns {
          .#{with-surfix("col-#{$i}", $breakpoint)} {
            @include gen-col($i, $columns, $gutter);
          }
        }
      }
    }
    // $context: "sm";
    // @include responsive-each($context: $context) {
    //   @for $i from 1 through $columns {
    //     .#{with-surfix("col-#{$i}", $context)} {
    //       @include gen-col($i, $columns, $gutter);
    //     }
    //   }
    // }
  }
}
